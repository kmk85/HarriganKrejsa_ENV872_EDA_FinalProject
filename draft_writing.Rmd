---
title: "draft final Project"
author: "Elise Harrigan and Katie Krejsa"
date: "4/19/2021"
output: pdf_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


[knitting](../ENV872_EDA_FinalProject/img/elephant.png)

## ELEPHANT MOVEMENT IN GABON, AFRICA

Elephants are universally some of the most beloved and threatened species in Africa. As a charismatic megafauna, they capture the attention of people as a majestic and powerful animal roaming the African forest and plains. But elephants are also critical in forest ecosystems. As elephant herds travel, they remove trees to create space, consume an incredible amounts of vegetation and use water bodies and dirt piles to cool off. The daily actions of elephants inevitably leave a network of trails in their wake. To be able to better understand forest elephants' daily movements, we will study the trails used by the forest elephant of Gabon. 

Gabon is a country located on the western coast of Africa and covered in dense forest. Due to the forest canopy coverage, collecting data on the elephant trails can be difficult because satellite imagery is not able to penetrate past the top layers of the forest to capture the trail locations on the forest floor. In order to gather more information on elephant movements, data were collected in the field and was analyzed in this study. 


## STUDY QUESTIONS

This study focused on understanding the use of elephant trails and the frequency of travel on these trails. We analyzed the condition of trail as poor, medium or heavy trodden, the width of the trail, and the use denoted by the start, stop or change direction in the trail. We aimed to answer the following questions to gain information on the activity level of elephants and the use of the trails.

1. What is the condition and use of the trail? 
2. What is frequency and number of days traveled on each trail? 


By studying and better understanding the movements and patterns of elephants, future researchers will be able to compare how elephants react to human disturbance, how they impact the vegetation, and their patterns across the landscape. 

## DATASETS

The data used for this project were collected in and around Ivindo National Park, Gabon by a team of Duke University researchers, local field guides, and forest peoples. Two datasets were provided to us by Dr Amelia Meier of Duke University. Data for waypoints and tracklogs were collected in the field with GPS units as the team searched for and walked along forest elephant trails. The data are both spatial, containing geographic coordinates, and temporal, containing date and time components.

The tracklogs dataset includes GPS data where the field teams were walking. Data contained in this dataset includes the site name (Ivindo), date, time, latitude, and longitude, where everything is recorded in decimal degrees WGS84. The dates of the tracklogs range from February 2018 to May 2018. 

The waypoints dataset includes the waypoints taken by field teams when they started walking on an elephant trail or if the elephant trail changed characteristics. The data contained in this dataset includes date, time, latitude, longitude, trail characteristics (cmt), data on where the elephant trails started and stopped and when the field team got on or of a trail (name), and the symbol used in the GPS (sym). More specifically, the "name" field includes "start" or "stop" if the team got on or off a trail, "trstart" or "trstop" if the trail itself started or disappeared, "change" if a characteristic of the trail change, and "jct" if they came to a trail crossing. In the cmt field, there are two sets of information: a letter (P = poor, M = medium, H = heavy) representing how heavily trodden the path is and a number representing the width of the trail in cm. If the cmt section is blank then the details previously recorded remained the same. Data contained in this dataset was also recorded in decimal degrees WGS84 and the dates of data collection also range from February 2018 to May 2018.
 

__Dataset__  | __Variables__| __Range or Unique Values__| __Central Tendancies__
-------------|--------------|---------------------------|------------------------
IV_tracklogs |site          |                           |                                                              -       |date          |2018-02-05 - 2018-05-25    |
     -       |time          |                           |
     -       |latitude      |-0.3429768 - 0.6005945     |mean = 0.07083619; median = -0.1230693
     -       |longitude     |12.43589 - 12.81332        |mean = 12.60479; median = 12.60231
IV_wgts      |date          |2018-02-06 - 2018-05-25    |
     -       |time          |                           |
     -       |latitude      |-0.335521 - 0.599461       |mean = 0.2283088; median = 0.486579
     -       |longitude     |12.43817 - 12.80200        |mean = 12.66357; median = 12.72618
     -       |name          |                           |
     -       |sym           |                           |
     -       |cmt (letter)  | "P" "M" "W"               |
     -       |cmt (number)  | 35 - 75                   |mean = 50; median = 47.5
     

__Data Wrangling__

The overall goal in wrangling our data was to combine the two files so that all the points on the tracklogs are assigned trail characteristics (on trail, off trail, size and use of trails). Doing this would then allow us to quantify the types of trails that elephants use in which contexts.

The tracklogs dataset included a total of 76,098 observations of 6 variables (X, site, date, time, lat, and lon), and the waypoints dataset included a total of 452 observations of 8 variables (X, date, time, lat, lon, name, sym, and cmt). To assign trail characteristics (cmt and name) from the waypoints dataset to the tracklogs dataset, we could not do a simple join because the dates and times did not match up exactly. So instead, we first identified all of the unique dates in the waypoints dataset. We then filtered the tracklogs dataset so that it only included the unique dates found in the waypoints dataset. This reduced the number of tracklog observations to 42,179.

Because there are many observations on each day, we next combined the date and time columns to create a combined date_time column in each of the two datasets and arranged both datasets by ascending order of date_time. As stated earlier, the two datasets do not have exact matching date_time entires, so to assign cmt column values to the tracklogs dataset based on date_time, we transferred cmt values to the tracklogs dataset if the tracklogs date_time was within a window of the date_time column of the waypoints dataset using a for loop. We then filtered out all of the "NA" values of the resulting tracklogs dataset. We were told that if the "cmt" column is blank then the details previously recorded remained the same; Therefore, we filled in blanks with previously recorded values by first filling cells of empty strings with "NA" and then using the fill() command. Because the cmt column holds two pieces of information (a letter representing how heavily trodden the path is and a number representing the width of the trail), we separated these into two separate columns using the str_extract() command. Last, we assigned the "name" column values to the tracklogs dataset in the same way as we assigned the cmt values, using a for loop.

## EXPLORATORY ANALYSIS
In order to better understand the elephant trail data, we used exploration methods to examine these data and their relationship to one another. First, we wanted to see the total amount of trails for each use type (P, M, W) to see which type of trail was most present. By summarising each use of trail, we were able to see the Poor trails were the most commonly described trail. 

__Use of Trail __            | __Total Amount__
--------------------         |---------------------------
Poor (P)                     | 27,218
Medium (M)                   | 13,666
Heavy (W)                    | 26

To better visualize these data, we used spatial mapping through mapview to get an idea of where the trails are located and the direction the elephants are traveling. Given the size of the dataset, we created a subset of these data to just look at one date where all three trail types were present. On April 15, 2018, all three trails were documented.

This map shows how the elephants traveled with each dot representing a point captured. It was interesting to see a congregation of points and a change from poorly trodden to medium and heavy trodden trails. Further investigation could occur using remote sensing techniques such as lidar, would allow us to see if there is a environmental feature such as a water body, bringing the elephants to this area. 

```{r}
##Insert code for map


```


## ANALYSIS

A research question for this study was to understand the condition and use of each trail and its level of significance. To answer this we analyzed the widths of each type of trail. 

```{r plots by width}
##for caption: On the x axis, the three letters represent how heavily trodden the path is:  (P = poor, M = medium, W = heavy) and the width of the trail on the y-axis in centimeters. It is evident the poor and medium trails are similar in width and the heavy trails are much wider. 

width_plots <- ggplot(tracklogs, aes(x = use_cha, y = use_num)) +
  geom_boxplot(fill = "lightblue") + ggtitle("Trail type by width") + xlab("Type of Trail") + ylab("Width of trail (cm)") + mytheme

print(width_plots)


```

To test our assumptions about the significance of the width of trail to the type, we performed a statistical analysis using a linear regression. We ran a post-hoc Tukey test and found that, the heavily trodden trail is significantly wider than the poor and medium trodden trails, but the widths of the poor and medium trodden trails are not significantly different. 

```{r}
mod3 <- lm(data = tracklogs, use_num ~ use_cha)
  summary(mod3)
  TukeyHSD(aov(mod3))
  plot(TukeyHSD(aov(mod3)))
```

The second question we aimed to answer was to see the number of trail points occurring for each day. To do this, we examined the relationship between the days and the number of trails for each day. 

```{r}

##for caption: The poor trodden trails are more abundant earlier in the year and the medium trodden trails take over in late April-May timeframe. 

freq_plot <- ggplot(tracklogs, aes(x=date, fill = use_cha)) + 
  geom_bar() + 
  scale_fill_manual(values = c("darkseagreen3", "deepskyblue3", "deeppink")) +
  scale_x_date(date_breaks ="10 days", date_labels = "%Y-%m-%d", 
          guide = guide_axis(angle = 45)) + 
  (theme(legend.position = "right", 
        legend.text = element_text(size = 12), legend.title = element_text(size = 12))) +
  labs( y = "Count", 
        x = "Date", 
        title = "Number of Trail Points per Day", 
        fill = "Use of Trail") +
  mytheme

print(freq_plot)

```

 







  
